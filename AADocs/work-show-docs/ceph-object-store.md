#基于对象存储的项目架构
## 需求
解决大小图和json文件的存储问题
## 方案1
### 方案描述
保持原有架构不变，Ftp把图片存到本地（作为一个生产者，临时存储，临时缓存或者临时缓冲），
Ceph 从本地读取图片，存到自己的集群中，删除ftp 中的缓冲（作为一个消费者，作为最终的存储终端）。

### 需要解决的问题
1，什么时候清理缓存。  
2，如何对外提供数据读取服务。
#### 1，什么时候清理缓存
读取ftp 前一天的，或者之前某几天的数据，由Ceph 进行读取，
待存储到Ceph 之后，然后进行删除（需要验证可行性，FTP 需要分目录）  

ftp的目录结构大概如下（如此需要清理ftpdata 目录下，某个目录下面的内容即可）：    
ftpdata/3K01E84PAU00498/2017/12/15/15/2017_12_15_15_56_49_6318_1.jpg
ftpdata/3K01E84PAU00498/2017/12/15/15/2017_12_15_15_56_49_6318_0.jpg
ftpdata/3K01E84PAU00498/2017/12/15/15/2017_12_15_15_56_49_6318_0.json


#### 2，如何对外提供数据读取服务
对外提供的URL的时候  
1，先确认ftp 中是否有数据，如果有，则直接返回FTP 的URL  
2，如果没有，则到CEPH 集群中根据图片名字生成URL  
（需要验证可行性，FTP 数据该如何确认数据是否是真的存在  
数据的返回利用dubbo 接口实现（封装如上1,2 两个流程），
像静态细信息库一样（解决spark sql 以图搜图数据的返回））。

#### 备注
问题1的时候，涉及多个应用程序操作同一个资源的情况，也就是并发问题。  
（例如图片的URL 已经返回给平台，某张图片显示的是ftp的URL，
但是刚好在这个时候ceph 集群中存好了数据，
把ftp 的这张图片给删掉了。虽然几率可能很小，但是不排除这个可能性，通过dubbo 调用几率可以更小，
并且数据迁移到Ceph 可以放到后半夜进行。）


## 方案2
### 方案描述


